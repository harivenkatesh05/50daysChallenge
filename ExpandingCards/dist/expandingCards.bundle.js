(()=>{"use strict";function t(t){const e=document.createElement("template");return e.innerHTML=t,e.content.cloneNode(!0)}class e{#t;#e;constructor(e,s,a){const r=t('<div class="card"> <img class="image"/> <span class="name"></span> </div>');this.#t=r.querySelector(".card"),this.#e=this.#t.querySelector(".name"),this.#e.textContent=s.getTitle(e);this.#t.querySelector(".image").src=s.getImgSrc(e),this.cardID=e,this.isCollapsed=null,s.getCollapseState(e)?this.collapse():this.expand(),this.#s(a)}setDimension(t,e){this.#t.style.width=t,this.#t.style.height=e}appendTo(t){t.append(this.#t)}collapse(){this.isCollapsed=!0,this.#t.classList.add("collapse"),this.#t.classList.remove("expand")}expand(){this.isCollapsed=!1,this.#t.classList.add("expand"),this.#t.classList.remove("collapse")}getCollapseState(){return this.isCollapsed}#s(t){this.#t.addEventListener("click",(()=>{t.onClick(this.cardID,this)}))}}class s{constructor(){}onClick(t,e){e.getCollapseState()?e.expand():e.collapse()}}class a{#t;#a;constructor(e,a){this.dataStore=e,this.eventHandler=a||new s;const r=t('<div class="container"></div>');this.#t=r.querySelector(".container"),this.#a={},this.setDimension()}appendTo(t){t.appendChild(this.#t)}setDimension(){this.#t.style.width=this.dataStore.getWidth(),this.#t.style.height=this.dataStore.getHeight()}setCollapseState(t,e){e?this.#a[t].collapse():this.#a[t].expand()}reset(){this.#t.innerHTML=""}render(){this.reset();this.dataStore.getCardOrder().forEach((t=>{const s=new e(t,this.dataStore,this.eventHandler);s.appendTo(this.#t),this.#a[t]=s}))}}class r{constructor(t,e){this.dataStore=t,this.cardView=e}attach(){this.dataStore.addCollapseStateChangeObserver((t=>{this.onCardCollapseStateChanged(t)}))}onCardCollapseStateChanged(t){t.forEach((t=>{this.cardView.setCollapseState(t,this.dataStore.getCollapseState(t))}))}}class i{constructor(t){this.configure=t,this.collapseStates=[],this.collapseStatesObserver=[],this.cardInOpen=0,this.parser(t)}parser(t){const e=t.data;this.collapseStates=e.map(((t,e)=>0!==e))}setDimension(t,e){this.configure.width=t,this.configure.height=e}setCollapseState(t){this.collapseStates=t}getWidth(){return this.configure.width}getHeight(){return this.configure.height}getCardOrder(){const t=this.configure.data.length;return Array.from({length:t},((t,e)=>e))}getTitle(t){return this.configure.data[t].title}getImgSrc(t){return this.configure.data[t].imgSrc}getCollapseState(t){return this.collapseStates[t]}changeOpenCard(t){const e=this.collapseStates[t];e&&(this.collapseStates[t]=!e,this.collapseStates[this.cardInOpen]=!0,function(t,...e){t.forEach((t=>t(...e)))}(this.collapseStatesObserver,[t,this.cardInOpen]),this.cardInOpen=t)}addCollapseStateChangeObserver(t){this.collapseStatesObserver.push(t)}}class o extends s{constructor(t){super(),this.dataStore=t}onClick(t,e){this.dataStore.changeOpenCard(t)}}class n{#r;#i;#o;constructor(t,e){this.#r=new i(e),this.#o=new o(this.#r);const s=n.getAbstractDataStore(this.#r);this.#i=new a(s,this.#o);new r(this.#r,this.#i).attach(),this.#i.appendTo(t),this.#i.render()}setDimension(t,e){this.#r.setDimension(t,e),this.#i.setDimension()}static getAbstractDataStore(t){return new class extends class{constructor(){}getWidth(){}getHeight(){}getCardOrder(){}getTitle(t){}getImgSrc(t){}getCollapseState(t){}}{#r;constructor(t){super(),this.#r=t}getWidth(){return this.#r.getWidth()||"100%"}getHeight(){return this.#r.getHeight()||"100%"}getCardOrder(){return this.#r.getCardOrder()}getTitle(t){return this.#r.getTitle(t)}getImgSrc(t){return this.#r.getImgSrc(t)}getCollapseState(t){const e=this.#r.getCollapseState(t);return void 0===e||e}}(t)}}window.ExpandingCards=n})();